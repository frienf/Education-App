(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16],{1339:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(5155),i=r(2970),o=r(7168),s=r(9852),n=r(8482),d=r(2115);function l(){let{videoUrl:e,addComment:t,currentTime:r,setCurrentTime:l,fetchVideoData:c,videoId:u,error:m,comments:v}=(0,i.K)(),[f,g]=(0,d.useState)(""),[p,h]=(0,d.useState)(null),[b,x]=(0,d.useState)(!0),y=(0,d.useRef)(null);return(0,d.useEffect)(()=>{u&&(x(!0),c(u).finally(()=>{x(!1)}))},[u,c]),(0,d.useEffect)(()=>{let e=e=>{"https://www.youtube.com"===e.origin&&"onStateChange"===e.data.event&&e.data.info&&"number"==typeof e.data.info.currentTime&&l(Math.floor(e.data.info.currentTime))};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)},[l]),(0,a.jsxs)(n.Zp,{className:"w-full max-w-4xl mx-auto",children:[(0,a.jsx)(n.aR,{className:"space-y-2",children:(0,a.jsx)(n.ZB,{className:"text-2xl font-bold",children:"Video Player"})}),(0,a.jsxs)(n.Wu,{className:"space-y-4",children:[(0,a.jsx)("div",{className:"relative w-full aspect-video bg-black rounded-lg overflow-hidden",children:m||p?(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-4 bg-red-900/50 text-red-200 rounded-lg",children:m||p}):b?(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-4 bg-black text-gray-300 rounded-lg",children:"Loading video..."}):e?e.includes("youtube.com")?(0,a.jsx)("iframe",{src:"".concat(e,"&enablejsapi=1"),className:"absolute inset-0 w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"}):(0,a.jsx)("video",{ref:y,src:e,controls:!0,className:"absolute inset-0 w-full h-full",onTimeUpdate:()=>{y.current&&!isNaN(y.current.currentTime)&&l(Math.floor(y.current.currentTime))},onError:()=>{h("Failed to load video. Please check the URL and try again.")},preload:"metadata"}):(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-4 bg-black text-gray-300 rounded-lg",children:"No video available"})}),(0,a.jsxs)("div",{className:"w-full bg-black rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,a.jsx)(s.p,{placeholder:"Add a comment",value:f,onChange:e=>g(e.target.value),className:"flex-1 bg-gray-900 text-gray-100 placeholder-gray-500 border-gray-800"}),(0,a.jsx)(o.$,{onClick:()=>{if(f.trim()&&u){var a;t({text:f,timestamp:Math.floor((null==e?void 0:e.includes("youtube.com"))?r:(null==(a=y.current)?void 0:a.currentTime)||0),video_id:u}),g("")}},className:"whitespace-nowrap bg-gray-900 hover:bg-gray-800 text-gray-100 border-gray-800",children:"Add Comment"})]}),(0,a.jsx)("div",{className:"mt-4 space-y-2",children:v.map(e=>(0,a.jsxs)("div",{className:"bg-gray-900 p-3 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-gray-100",children:e.text}),(0,a.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:new Date(1e3*e.timestamp).toLocaleTimeString()})]},e.id))})]})]})]})}},2970:(e,t,r)=>{"use strict";r.d(t,{K:()=>o});var a=r(5453);let i="550e8400-e29b-41d4-a716-446655440000",o=(0,a.v)(e=>({videoId:i,videoUrl:null,comments:[],currentTime:0,defaultVideoId:i,fetchVideoData:async t=>{try{let r="default"===t?i:t,a=await fetch("/api/video?videoId=".concat(r));if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));let{comments:o,video:s}=await a.json();if(!s)return void console.error("Video not found");let n=s.url;if(s.url.includes("youtube.com/shorts/")){let e=s.url.split("/shorts/")[1];n="https://www.youtube.com/embed/".concat(e,"?autoplay=0&rel=0&modestbranding=1")}else if(s.url.includes("youtube.com/watch?v=")){let e=s.url.split("v=")[1];n="https://www.youtube.com/embed/".concat(e,"?autoplay=0&rel=0&modestbranding=1")}e({videoId:r,videoUrl:n,comments:o||[]})}catch(t){console.error("Failed to fetch video data:",t),e(e=>({...e,videoUrl:null,error:"Failed to load video. Please try again."}))}},addComment:async t=>{try{let r=await fetch("/api/video",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t.text,timestamp:t.timestamp,videoId:t.video_id})}),a=await r.json();e(e=>({comments:[...e.comments||[],a]}))}catch(e){console.error("Failed to add comment:",e)}},updateComment:async(t,r)=>{try{let a=await fetch("/api/video",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,...r})}),i=await a.json();e(e=>({comments:e.comments.map(e=>e.id===t?i:e)}))}catch(e){console.error("Failed to update comment:",e)}},deleteComment:async t=>{try{await fetch("/api/video",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})}),e(e=>({comments:e.comments.filter(e=>e.id!==t)}))}catch(e){console.error("Failed to delete comment:",e)}},setVideoId:t=>e({videoId:t}),setCurrentTime:t=>e({currentTime:t}),seekTo:t=>{if(isNaN(t)||t<0)return;e({currentTime:Math.floor(t)});let r=document.querySelector("video");r&&(r.currentTime=Math.floor(t))}}))},3444:(e,t,r)=>{Promise.resolve().then(r.bind(r,3658))},3658:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var a=r(5155),i=r(2970),o=r(1339),s=r(6408),n=r(2115);function d(e){let{params:t}=e,{setVideoId:r,videoUrl:d,fetchVideoData:l}=(0,i.K)();return(0,n.useEffect)(()=>{r(t.id),l(t.id)},[t.id,r,l]),(0,a.jsxs)(s.P.div,{className:"container mx-auto p-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold mb-4",children:["Video ",t.id]}),(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(o.A,{})})})]})}},7168:(e,t,r)=>{"use strict";r.d(t,{$:()=>d,r:()=>n});var a=r(5155);r(2115);var i=r(9708),o=r(2085),s=r(9434);let n=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:t,variant:r,size:o,asChild:d=!1,...l}=e,c=d?i.DX:"button";return(0,a.jsx)(c,{"data-slot":"button",className:(0,s.cn)(n({variant:r,size:o,className:t})),...l})}},8482:(e,t,r)=>{"use strict";r.d(t,{Wu:()=>d,ZB:()=>n,Zp:()=>o,aR:()=>s});var a=r(5155);r(2115);var i=r(9434);function o(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,i.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function s(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,i.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function n(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,i.cn)("leading-none font-semibold",t),...r})}function d(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,i.cn)("px-6",t),...r})}},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var a=r(2596),i=r(9688);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.QP)((0,a.$)(t))}},9852:(e,t,r)=>{"use strict";r.d(t,{p:()=>o});var a=r(5155);r(2115);var i=r(9434);function o(e){let{className:t,type:r,...o}=e;return(0,a.jsx)("input",{type:r,"data-slot":"input",className:(0,i.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...o})}}},e=>{var t=t=>e(e.s=t);e.O(0,[352,628,441,684,358],()=>t(3444)),_N_E=e.O()}]);